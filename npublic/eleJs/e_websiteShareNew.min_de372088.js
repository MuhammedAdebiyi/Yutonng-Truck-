"use strict";$define(["qrcode","clipboard","pl_util"],function(){return{init:function(){var t,e=this._params,n=e.id,c=e.cid,o=this.scope,e=e.propJson,i={title:encodeURIComponent(document.title),desc:function(t){for(var e,n=document.getElementsByTagName("meta"),c=0;e=n[c++];)if(e.getAttribute("name")&&e.getAttribute("name").toLowerCase()===t)return encodeURIComponent(e.content)}("description"),img:0!==(t=function(e){var n=null;try{n=Array.prototype.slice.call(e,0)}catch(t){n=new Array;for(var c=0,o=e.length;c<o;c++)n.push(e[c])}return n}(document.body.getElementsByTagName("img"))).length?encodeURIComponent(t[0].src):void 0,url:encodeURIComponent(location.href)};function r(t){t.attr("data-clipboard-text",location.href).addClass("js-copy");t=new ClipboardJS("#".concat(c," .").concat(n," .js-copy"));t.on("success",function(t){alert("复制链接成功"),t.clearSelection()}),t.on("error",function(t){alert("当前浏览器不支持此功能，请手动复制。")})}function a(n){var c=$.isWechat()?"/npublic/img/share-bwechat.png":"/npublic/img/share-browser.png";n.on("click",function(t){var e;"IMG"===t.target.tagName&&"-1"==t.target.className.indexOf("p_img")||((e=document.createElement("img")).src=c,e.setAttribute("style","position: fixed; left: 0; top: 0; width: 100%; height: 100%; z-index: 99999;"),e.addEventListener("click",function(){e.parentNode.removeChild(e)}),n[0].appendChild(e),setTimeout(function(){e.parentNode.removeChild(e)},1e3))})}"button"==e.style?(o.find(".p_qrcode").qrcode({text:location.href,width:120,height:120,foreground:"#000",background:"#fff"}),r(o.find(".p_copyLink")),o.on("click",".p_sharebtn",function(){var t;$.isWechat()?((t=document.createElement("img")).src="/npublic/img/share-bwechat.png",t.setAttribute("style","position: fixed; left: 0; top: 0; width: 100%; height: 100%; z-index: 99999;"),t.addEventListener("click",function(){t.parentNode.removeChild(t)}),o.append(t),setTimeout(function(){t.parentNode.removeChild(t)},1e3)):o.find(".p_pop").show()}),o.on("click",".p_close",function(){o.find(".p_pop").hide()})):function(){var t,e={qq:"https://connect.qq.com/widget/shareqq/index.html?url=".concat(i.url,"&title=").concat(i.title,"&desc=").concat(i.desc,"&pics=").concat(i.img),qzone:"https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=".concat(i.url,"&title=").concat(i.title,"&summary=").concat(i.desc,"&pics=").concat(i.img,"&desc=&site="),weibo:"https://service.weibo.com/share/share.php?url=".concat(i.url,"&title=").concat(i.title,"&pic=").concat(i.img),wechat:"javascript:;",moments:"javascript:;",linkedin:"https://www.linkedin.com/shareArticle?mini=true&ro=true&title=".concat(i.title,"&url=").concat(i.url,"&summary=").concat(i.desc,"&armin=armin"),facebook:"https://www.facebook.com/sharer.php?u=".concat(i.url,"&title=").concat(i.title,"&images=").concat(i.img,"&summary=").concat(i.desc),twitter:"https://twitter.com/intent/tweet?text=".concat(i.title,"&url=").concat(i.url),pinterest:"https://www.pinterest.com/pin/create/button/?url=".concat(i.url,"&description=").concat(i.desc,"&media=").concat(i.img),tumblr:"https://www.tumblr.com/widgets/share/tool?shareSource=legacy&canonicalUrl=&url=".concat(i.url,"&title=").concat(i.title),copyLink:"javascript:;"};for(t in e){var n=o.find(".p_shareItem[key='"+t+"']");n.attr("href",e[t]),n.attr("rel","nofollow"),"javascript:;"==e[t]&&n.attr("target",""),"copyLink"==t?r(n):"moments"==t&&isMo()?(n.show(),a(n)):"wechat"==t&&(isMo()?a:function(t){t.append('\n                <div class="p_wxShareCon">\n                    <div class="p_qrcode"></div>\n                </div>\n            '),t.find(".p_wxShareCon").qrcode({text:location.href,width:120,height:120,foreground:"#000",background:"#fff"}),t.hover(function(){$(this).find(".p_wxShareCon").show()},function(){$(this).find(".p_wxShareCon").hide()})})(n)}}()}}});