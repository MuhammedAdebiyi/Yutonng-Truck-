"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(r){var J,K,L,M,N,O,v,t={},w={},x={},P={treeId:"",treeObj:null,view:{addDiyDom:null,autoCancelSelected:!0,dblClickExpand:!0,expandSpeed:"fast",fontCss:{},nameIsHTML:!1,selectedMulti:!0,showIcon:!0,showLine:!0,showTitle:!0,txtSelectedEnable:!1},data:{key:{isParent:"isParent",children:"children",name:"name",title:"",url:"url",icon:"icon"},simpleData:{enable:!1,idKey:"id",pIdKey:"pId",rootPId:null},keep:{parent:!1,leaf:!1}},async:{enable:!1,contentType:"application/x-www-form-urlencoded",type:"post",dataType:"text",headers:{},xhrFields:{},url:"",autoParam:[],otherParam:[],dataFilter:null},callback:{beforeAsync:null,beforeClick:null,beforeDblClick:null,beforeRightClick:null,beforeMouseDown:null,beforeMouseUp:null,beforeExpand:null,beforeCollapse:null,beforeRemove:null,onAsyncError:null,onAsyncSuccess:null,onNodeCreated:null,onClick:null,onDblClick:null,onRightClick:null,onMouseDown:null,onMouseUp:null,onExpand:null,onCollapse:null,onRemove:null}},y=[function(d){var e=d.treeObj,t=g.event;e.bind(t.NODECREATED,function(e,t,n){h.apply(d.callback.onNodeCreated,[e,t,n])}),e.bind(t.CLICK,function(e,t,n,o,r){h.apply(d.callback.onClick,[t,n,o,r])}),e.bind(t.EXPAND,function(e,t,n){h.apply(d.callback.onExpand,[e,t,n])}),e.bind(t.COLLAPSE,function(e,t,n){h.apply(d.callback.onCollapse,[e,t,n])}),e.bind(t.ASYNC_SUCCESS,function(e,t,n,o){h.apply(d.callback.onAsyncSuccess,[e,t,n,o])}),e.bind(t.ASYNC_ERROR,function(e,t,n,o,r,a){h.apply(d.callback.onAsyncError,[e,t,n,o,r,a])}),e.bind(t.REMOVE,function(e,t,n){h.apply(d.callback.onRemove,[e,t,n])}),e.bind(t.SELECTED,function(e,t,n){h.apply(d.callback.onSelected,[t,n])}),e.bind(t.UNSELECTED,function(e,t,n){h.apply(d.callback.onUnSelected,[t,n])})}],z=[function(e){var t=g.event;e.treeObj.unbind(t.NODECREATED).unbind(t.CLICK).unbind(t.EXPAND).unbind(t.COLLAPSE).unbind(t.ASYNC_SUCCESS).unbind(t.ASYNC_ERROR).unbind(t.REMOVE).unbind(t.SELECTED).unbind(t.UNSELECTED)}],A=[function(t){var n=e.getCache(t);n||(n={},e.setCache(t,n)),n.nodes=[],n.doms=[]}],B=[function(t,n,o,r,a,d){var i,l;o&&(i=e.getRoot(t),l=e.nodeChildren(t,o),o.level=n,o.tId=t.treeId+"_"+ ++i.zId,o.parentTId=r?r.tId:null,o.open="string"==typeof o.open?h.eqs(o.open,"true"):!!o.open,n=e.nodeIsParent(t,o),h.isArray(l)?(e.nodeIsParent(t,o,!0),o.zAsync=!0):(n=e.nodeIsParent(t,o,n),o.open=!(!n||t.async.enable)&&o.open,o.zAsync=!n),o.isFirstNode=a,o.isLastNode=d,o.getParentNode=function(){return e.getNodeCache(t,o.parentTId)},o.getPreNode=function(){return e.getPreNode(t,o)},o.getNextNode=function(){return e.getNextNode(t,o)},o.getIndex=function(){return e.getNodeIndex(t,o)},o.getPath=function(){return e.getNodePath(t,o)},o.isAjaxing=!1,e.fixPIdKeyValue(t,o))}],u=[function(t){var n=t.target,o=e.getSetting(t.data.treeId),r="",a=null,d="",i="",l=null,s=null,c=null;if(h.eqs(t.type,"mousedown")?i="mousedown":h.eqs(t.type,"mouseup")?i="mouseup":h.eqs(t.type,"contextmenu")?i="contextmenu":h.eqs(t.type,"click")?h.eqs(n.tagName,"span")&&null!==n.getAttribute("treeNode"+g.id.SWITCH)?(r=h.getNodeMainDom(n).id,d="switchNode"):(c=h.getMDom(o,n,[{tagName:"a",attrName:"treeNode"+g.id.A}]))&&(r=h.getNodeMainDom(c).id,d="clickNode"):h.eqs(t.type,"dblclick")&&(i="dblclick",c=h.getMDom(o,n,[{tagName:"a",attrName:"treeNode"+g.id.A}]))&&(r=h.getNodeMainDom(c).id,d="switchNode"),0<i.length&&0==r.length&&(c=h.getMDom(o,n,[{tagName:"a",attrName:"treeNode"+g.id.A}]))&&(r=h.getNodeMainDom(c).id),0<r.length)switch(a=e.getNodeCache(o,r),d){case"switchNode":e.nodeIsParent(o,a)&&(h.eqs(t.type,"click")||h.eqs(t.type,"dblclick")&&h.apply(o.view.dblClickExpand,[o.treeId,a],o.view.dblClickExpand))?l=J:d="";break;case"clickNode":l=K}switch(i){case"mousedown":s=L;break;case"mouseup":s=M;break;case"dblclick":s=N;break;case"contextmenu":s=O}return{stop:!1,node:a,nodeEventType:d,nodeEventCallback:l,treeEventType:i,treeEventCallback:s}}],C=[function(t){var n=e.getRoot(t);n||(n={},e.setRoot(t,n)),e.nodeChildren(t,n,[]),n.expandTriggerFlag=!1,n.curSelectedList=[],n.noSelection=!0,n.createdNodes=[],n.zId=0,n._ver=(new Date).getTime()}],D=[],E=[],F=[],G=[],H=[],e={addNodeCache:function(t,n){e.getCache(t).nodes[e.getNodeCacheId(n.tId)]=n},getNodeCacheId:function(e){return e.substring(e.lastIndexOf("_")+1)},addAfterA:function(e){E.push(e)},addBeforeA:function(e){D.push(e)},addInnerAfterA:function(e){G.push(e)},addInnerBeforeA:function(e){F.push(e)},addInitBind:function(e){y.push(e)},addInitUnBind:function(e){z.push(e)},addInitCache:function(e){A.push(e)},addInitNode:function(e){B.push(e)},addInitProxy:function(e,t){t?u.splice(0,0,e):u.push(e)},addInitRoot:function(e){C.push(e)},addNodesData:function(t,n,o,r){var a=e.nodeChildren(t,n);a?o>=a.length&&(o=-1):(a=e.nodeChildren(t,n,[]),o=-1),0<a.length&&0===o?(a[0].isFirstNode=!1,j.setNodeLineIcos(t,a[0])):0<a.length&&o<0&&(a[a.length-1].isLastNode=!1,j.setNodeLineIcos(t,a[a.length-1])),e.nodeIsParent(t,n,!0),o<0?e.nodeChildren(t,n,a.concat(r)):(t=[o,0].concat(r),a.splice.apply(a,t))},addSelectedNode:function(t,n){var o=e.getRoot(t);e.isSelectedNode(t,n)||o.curSelectedList.push(n)},addCreatedNode:function(t,n){(t.callback.onNodeCreated||t.view.addDiyDom)&&e.getRoot(t).createdNodes.push(n)},addZTreeTools:function(e){H.push(e)},exSetting:function(e){r.extend(!0,P,e)},fixPIdKeyValue:function(e,t){e.data.simpleData.enable&&(t[e.data.simpleData.pIdKey]=t.parentTId?t.getParentNode()[e.data.simpleData.idKey]:e.data.simpleData.rootPId)},getAfterA:function(){for(var e=0,t=E.length;e<t;e++)E[e].apply(this,arguments)},getBeforeA:function(){for(var e=0,t=D.length;e<t;e++)D[e].apply(this,arguments)},getInnerAfterA:function(){for(var e=0,t=G.length;e<t;e++)G[e].apply(this,arguments)},getInnerBeforeA:function(){for(var e=0,t=F.length;e<t;e++)F[e].apply(this,arguments)},getCache:function(e){return x[e.treeId]},getNodeIndex:function(t,n){if(!n)return null;for(var o=n.parentTId?n.getParentNode():e.getRoot(t),r=0,a=(o=e.nodeChildren(t,o)).length-1;r<=a;r++)if(o[r]===n)return r;return-1},getNextNode:function(t,n){if(!n)return null;for(var o=n.parentTId?n.getParentNode():e.getRoot(t),r=0,a=(o=e.nodeChildren(t,o)).length-1;r<=a;r++)if(o[r]===n)return r==a?null:o[r+1];return null},getNodeByParam:function(t,n,o,r){if(!n||!o)return null;for(var a=0,d=n.length;a<d;a++){var i=n[a];if(i[o]==r)return n[a];if(i=e.nodeChildren(t,i),i=e.getNodeByParam(t,i,o,r))return i}return null},getNodeCache:function(t,n){if(!n)return null;n=x[t.treeId].nodes[e.getNodeCacheId(n)];return n||null},getNodePath:function(e,t){return t?((n=t.parentTId?t.getParentNode().getPath():[])&&n.push(t),n):null;var n},getNodes:function(t){return e.nodeChildren(t,e.getRoot(t))},getNodesByParam:function(t,n,o,r){if(!n||!o)return[];for(var a=[],d=0,i=n.length;d<i;d++){var l=n[d];l[o]==r&&a.push(l),l=e.nodeChildren(t,l),a=a.concat(e.getNodesByParam(t,l,o,r))}return a},getNodesByParamFuzzy:function(t,n,o,r){if(!n||!o)return[];for(var a=[],r=r.toLowerCase(),d=0,i=n.length;d<i;d++){var l=n[d];"string"==typeof l[o]&&-1<n[d][o].toLowerCase().indexOf(r)&&a.push(l),l=e.nodeChildren(t,l),a=a.concat(e.getNodesByParamFuzzy(t,l,o,r))}return a},getNodesByFilter:function(t,n,o,r,a){if(!n)return r?null:[];for(var d=r?null:[],i=0,l=n.length;i<l;i++){var s=n[i];if(h.apply(o,[s,a],!1)){if(r)return s;d.push(s)}if(s=e.nodeChildren(t,s),s=e.getNodesByFilter(t,s,o,r,a),r&&s)return s;d=r?s:d.concat(s)}return d},getPreNode:function(t,n){if(!n)return null;for(var o=n.parentTId?n.getParentNode():e.getRoot(t),r=0,a=(o=e.nodeChildren(t,o)).length;r<a;r++)if(o[r]===n)return 0==r?null:o[r-1];return null},getRoot:function(e){return e?w[e.treeId]:null},getRoots:function(){return w},getSetting:function(e){return t[e]},getSettings:function(){return t},getZTreeTools:function(e){return(e=this.getRoot(this.getSetting(e)))?e.treeTools:null},initCache:function(){for(var e=0,t=A.length;e<t;e++)A[e].apply(this,arguments)},initNode:function(){for(var e=0,t=B.length;e<t;e++)B[e].apply(this,arguments)},initRoot:function(){for(var e=0,t=C.length;e<t;e++)C[e].apply(this,arguments)},isSelectedNode:function(t,n){for(var o=e.getRoot(t),r=0,a=o.curSelectedList.length;r<a;r++)if(n===o.curSelectedList[r])return!0;return!1},nodeChildren:function(e,t,n){return t?(e=e.data.key.children,void 0!==n&&(t[e]=n),t[e]):null},nodeIsParent:function(e,t,n){return!!t&&(e=e.data.key.isParent,void 0!==n?("string"==typeof n&&(n=h.eqs(n,"true")),t[e]=!!n):t[e]="string"==typeof t[e]?h.eqs(t[e],"true"):!!t[e],t[e])},nodeName:function(e,t,n){return e=e.data.key.name,void 0!==n&&(t[e]=n),""+t[e]},nodeTitle:function(e,t){return""+t[""===e.data.key.title?e.data.key.name:e.data.key.title]},removeNodeCache:function(t,n){var o=e.nodeChildren(t,n);if(o)for(var r=0,a=o.length;r<a;r++)e.removeNodeCache(t,o[r]);e.getCache(t).nodes[e.getNodeCacheId(n.tId)]=null},removeSelectedNode:function(t,n){for(var o=e.getRoot(t),r=0,a=o.curSelectedList.length;r<a;r++)n!==o.curSelectedList[r]&&e.getNodeCache(t,o.curSelectedList[r].tId)||(o.curSelectedList.splice(r,1),t.treeObj.trigger(g.event.UNSELECTED,[t.treeId,n]),r--,a--)},setCache:function(e,t){x[e.treeId]=t},setRoot:function(e,t){w[e.treeId]=t},setZTreeTools:function(){for(var e=0,t=H.length;e<t;e++)H[e].apply(this,arguments)},transformToArrayFormat:function(n,t){function o(t){r.push(t),(t=e.nodeChildren(n,t))&&(r=r.concat(e.transformToArrayFormat(n,t)))}if(!t)return[];var r=[];if(h.isArray(t))for(var a=0,d=t.length;a<d;a++)o(t[a]);else o(t);return r},transformTozTreeFormat:function(t,n){var o=t.data.simpleData.idKey,r=t.data.simpleData.pIdKey;if(!o||""==o||!n)return[];if(h.isArray(n)){for(var a=[],d={},i=0,l=n.length;i<l;i++)d[n[i][o]]=n[i];for(i=0,l=n.length;i<l;i++){var s=d[n[i][r]];(s&&n[i][o]!=n[i][r]?e.nodeChildren(t,s)||e.nodeChildren(t,s,[]):a).push(n[i])}return a}return[n]}},n={bindEvent:function(){for(var e=0,t=y.length;e<t;e++)y[e].apply(this,arguments)},unbindEvent:function(){for(var e=0,t=z.length;e<t;e++)z[e].apply(this,arguments)},bindTree:function(e){var t={treeId:e.treeId},o=e.treeObj;e.view.txtSelectedEnable||o.bind("selectstart",v).css({"-moz-user-select":"-moz-none"}),o.bind("click",t,n.proxy),o.bind("dblclick",t,n.proxy),o.bind("mouseover",t,n.proxy),o.bind("mouseout",t,n.proxy),o.bind("mousedown",t,n.proxy),o.bind("mouseup",t,n.proxy),o.bind("contextmenu",t,n.proxy)},unbindTree:function(e){e.treeObj.unbind("selectstart",v).unbind("click",n.proxy).unbind("dblclick",n.proxy).unbind("mouseover",n.proxy).unbind("mouseout",n.proxy).unbind("mousedown",n.proxy).unbind("mouseup",n.proxy).unbind("contextmenu",n.proxy)},doProxy:function(){for(var e=[],t=0,n=u.length;t<n;t++){var o=u[t].apply(this,arguments);if(e.push(o),o.stop)break}return e},proxy:function(t){var o=e.getSetting(t.data.treeId);if(!h.uCanDo(o,t))return!0;for(var r=!0,a=0,d=(o=n.doProxy(t)).length;a<d;a++){var i=o[a];i.nodeEventCallback&&(r=i.nodeEventCallback.apply(i,[t,i.node])&&r),i.treeEventCallback&&(r=i.treeEventCallback.apply(i,[t,i.node])&&r)}return r}},J=function(t,n){t=e.getSetting(t.data.treeId);if(n.open){if(0==h.apply(t.callback.beforeCollapse,[t.treeId,n],!0))return!0}else if(0==h.apply(t.callback.beforeExpand,[t.treeId,n],!0))return!0;return e.getRoot(t).expandTriggerFlag=!0,j.switchNode(t,n),!0},K=function(t,n){var o=e.getSetting(t.data.treeId),r=o.view.autoCancelSelected&&(t.ctrlKey||t.metaKey)&&e.isSelectedNode(o,n)?0:o.view.autoCancelSelected&&(t.ctrlKey||t.metaKey)&&o.view.selectedMulti?2:1;return 0==h.apply(o.callback.beforeClick,[o.treeId,n,r],!0)||(0==r?j.cancelPreSelectedNode(o,n):j.selectNode(o,n,2==r),o.treeObj.trigger(g.event.CLICK,[t,o.treeId,n,r])),!0},L=function(t,n){var o=e.getSetting(t.data.treeId);return h.apply(o.callback.beforeMouseDown,[o.treeId,n],!0)&&h.apply(o.callback.onMouseDown,[t,o.treeId,n]),!0},M=function(t,n){var o=e.getSetting(t.data.treeId);return h.apply(o.callback.beforeMouseUp,[o.treeId,n],!0)&&h.apply(o.callback.onMouseUp,[t,o.treeId,n]),!0},N=function(t,n){var o=e.getSetting(t.data.treeId);return h.apply(o.callback.beforeDblClick,[o.treeId,n],!0)&&h.apply(o.callback.onDblClick,[t,o.treeId,n]),!0},O=function(t,n){var o=e.getSetting(t.data.treeId);return h.apply(o.callback.beforeRightClick,[o.treeId,n],!0)&&h.apply(o.callback.onRightClick,[t,o.treeId,n]),"function"!=typeof o.callback.onRightClick},v=function(e){return"input"===(e=e.originalEvent.srcElement.nodeName.toLowerCase())||"textarea"===e},h={apply:function(e,t,n){return"function"==typeof e?e.apply(Q,t||[]):n},canAsync:function(t,n){var o=e.nodeChildren(t,n),r=e.nodeIsParent(t,n);return t.async.enable&&n&&r&&!(n.zAsync||o&&0<o.length)},clone:function(e){if(null===e)return null;var t,n=h.isArray(e)?[]:{};for(t in e)n[t]=e[t]instanceof Date?new Date(e[t].getTime()):"object"===_typeof(e[t])?h.clone(e[t]):e[t];return n},eqs:function(e,t){return e.toLowerCase()===t.toLowerCase()},isArray:function(e){return"[object Array]"===Object.prototype.toString.apply(e)},isElement:function(e){return"object"===("undefined"==typeof HTMLElement?"undefined":_typeof(HTMLElement))?e instanceof HTMLElement:e&&"object"===_typeof(e)&&null!==e&&1===e.nodeType&&"string"==typeof e.nodeName},$:function(e,t,n){return t&&"string"!=typeof t&&(n=t,t=""),"string"==typeof e?r(e,n?n.treeObj.get(0).ownerDocument:null):r("#"+e.tId+t,n?n.treeObj:null)},getMDom:function(e,t,n){if(!t)return null;for(;t&&t.id!==e.treeId;){for(var o=0,r=n.length;t.tagName&&o<r;o++)if(h.eqs(t.tagName,n[o].tagName)&&null!==t.getAttribute(n[o].attrName))return t;t=t.parentNode}return null},getNodeMainDom:function(e){return r(e).parent("li").get(0)||r(e).parentsUntil("li").parent().get(0)},isChildOrSelf:function(e,t){return 0<r(e).closest("#"+t).length},uCanDo:function(){return!0}},j={addNodes:function(t,n,o,r,a){var d,i,s=e.nodeIsParent(t,n);t.data.keep.leaf&&n&&!s||(h.isArray(r)||(r=[r]),t.data.simpleData.enable&&(r=e.transformTozTreeFormat(t,r)),n?(s=l(n,g.id.SWITCH,t),d=l(n,g.id.ICON,t),i=l(n,g.id.UL,t),n.open||(j.replaceSwitchClass(n,s,g.folder.CLOSE),j.replaceIcoClass(n,d,g.folder.CLOSE),n.open=!1,i.css({display:"none"})),e.addNodesData(t,n,o,r),j.createNodes(t,n.level+1,r,n,o),a||j.expandCollapseParentNode(t,n,!0)):(e.addNodesData(t,e.getRoot(t),o,r),j.createNodes(t,0,r,null,o)))},appendNodes:function(t,n,o,r,a,d,i){if(!o)return[];var l,s,c=[],u=r||e.getRoot(t);(!(u=e.nodeChildren(t,u))||a>=u.length-o.length)&&(a=-1);for(var h=0,g=o.length;h<g;h++){var p=o[h];d&&(l=(0===a||u.length==o.length)&&0==h,s=a<0&&h==o.length-1,e.initNode(t,n,p,r,l,s,i),e.addNodeCache(t,p)),l=e.nodeIsParent(t,p),s=[];var f=e.nodeChildren(t,p);f&&0<f.length&&(s=j.appendNodes(t,n+1,f,p,-1,d,i&&p.open)),i&&(j.makeDOMNodeMainBefore(c,t,p),j.makeDOMNodeLine(c,t,p),e.getBeforeA(t,p,c),j.makeDOMNodeNameBefore(c,t,p),e.getInnerBeforeA(t,p,c),j.makeDOMNodeIcon(c,t,p),e.getInnerAfterA(t,p,c),j.makeDOMNodeNameAfter(c,t,p),e.getAfterA(t,p,c),l&&p.open&&j.makeUlHtml(t,p,c,s.join("")),j.makeDOMNodeMainAfter(c,t,p),e.addCreatedNode(t,p))}return c},appendParentULDom:function(t,n){var o=[],r=l(n,t);!r.get(0)&&n.parentTId&&(j.appendParentULDom(t,n.getParentNode()),r=l(n,t));var a=l(n,g.id.UL,t);a.get(0)&&a.remove(),a=e.nodeChildren(t,n),a=j.appendNodes(t,n.level+1,a,n,-1,!1,!0),j.makeUlHtml(t,n,o,a.join("")),r.append(o.join(""))},asyncNode:function asyncNode(a,b,c,d){var f,i,f=e.nodeIsParent(a,b);if(b&&!f)return h.apply(d),!1;if(b&&b.isAjaxing)return!1;if(0==h.apply(a.callback.beforeAsync,[a.treeId,b],!0))return h.apply(d),!1;b&&(b.isAjaxing=!0,l(b,g.id.ICON,a).attr({style:"",class:g.className.BUTTON+" "+g.className.ICO_LOADING}));var m={},k=h.apply(a.async.autoParam,[a.treeId,b],a.async.autoParam);for(f=0,i=k.length;b&&f<i;f++){var q=k[f].split("="),o=q;1<q.length&&(o=q[1],q=q[0]),m[o]=b[q]}if(k=h.apply(a.async.otherParam,[a.treeId,b],a.async.otherParam),h.isArray(k))for(f=0,i=k.length;f<i;f+=2)m[k[f]]=k[f+1];else for(var n in k)m[n]=k[n];var s=e.getRoot(a)._ver;return r.ajax({contentType:a.async.contentType,cache:!1,type:a.async.type,url:h.apply(a.async.url,[a.treeId,b],a.async.url),data:-1<a.async.contentType.indexOf("application/json")?JSON.stringify(m):m,dataType:a.async.dataType,headers:a.async.headers,xhrFields:a.async.xhrFields,success:function success(i){if(s==e.getRoot(a)._ver){var f=[];try{f=i&&0!=i.length?"string"==typeof i?eval("("+i+")"):i:[]}catch(k){f=i}b&&(b.isAjaxing=null,b.zAsync=!0),j.setNodeLineIcos(a,b),f&&""!==f?(f=h.apply(a.async.dataFilter,[a.treeId,b,f],f),j.addNodes(a,b,-1,f?h.clone(f):[],!!c)):j.addNodes(a,b,-1,[],!!c),a.treeObj.trigger(g.event.ASYNC_SUCCESS,[a.treeId,b,i]),h.apply(d)}},error:function(t,n,o){s==e.getRoot(a)._ver&&(b&&(b.isAjaxing=null),j.setNodeLineIcos(a,b),a.treeObj.trigger(g.event.ASYNC_ERROR,[a.treeId,b,t,n,o]))}}),!0},cancelPreSelectedNode:function(t,n,o){for(var r,a=e.getRoot(t).curSelectedList,d=a.length-1;0<=d;d--)if(n===(r=a[d])||!n&&(!o||o!==r)){if(l(r,g.id.A,t).removeClass(g.node.CURSELECTED),n){e.removeSelectedNode(t,n);break}a.splice(d,1),t.treeObj.trigger(g.event.UNSELECTED,[t.treeId,r])}},createNodeCallback:function(t){if(t.callback.onNodeCreated||t.view.addDiyDom)for(var n=e.getRoot(t);0<n.createdNodes.length;){var o=n.createdNodes.shift();h.apply(t.view.addDiyDom,[t.treeId,o]),t.callback.onNodeCreated&&t.treeObj.trigger(g.event.NODECREATED,[t.treeId,o])}},createNodes:function(t,n,o,a,d){var i,s,c,u;o&&0!=o.length&&(i=e.getRoot(t),s=!a||a.open||!!l(e.nodeChildren(t,a)[0],t).get(0),i.createdNodes=[],n=j.appendNodes(t,n,o,a,d,!0,s),a?(a=l(a,g.id.UL,t)).get(0)&&(c=a):c=t.treeObj,c&&(0<=d&&(u=c.children()[d]),0<=d&&u?r(u).before(n.join("")):c.append(n.join(""))),j.createNodeCallback(t))},destroy:function(o){o&&(e.initCache(o),e.initRoot(o),n.unbindTree(o),n.unbindEvent(o),o.treeObj.empty(),delete t[o.treeId])},expandCollapseNode:function(t,n,o,r,a){var d,i,s,c,u=e.getRoot(t);n?(i=e.nodeChildren(t,n),s=e.nodeIsParent(t,n),u.expandTriggerFlag&&(d=a,a=function(){d&&d(),n.open?t.treeObj.trigger(g.event.EXPAND,[t.treeId,n]):t.treeObj.trigger(g.event.COLLAPSE,[t.treeId,n])},u.expandTriggerFlag=!1),!n.open&&s&&(!l(n,g.id.UL,t).get(0)||i&&0<i.length&&!l(i[0],t).get(0))&&(j.appendParentULDom(t,n),j.createNodeCallback(t)),n.open==o?h.apply(a,[]):(o=l(n,g.id.UL,t),u=l(n,g.id.SWITCH,t),c=l(n,g.id.ICON,t),s?(n.open=!n.open,n.iconOpen&&n.iconClose&&c.attr("style",j.makeNodeIcoStyle(t,n)),n.open?(j.replaceSwitchClass(n,u,g.folder.OPEN),j.replaceIcoClass(n,c,g.folder.OPEN),0!=r&&""!=t.view.expandSpeed&&i&&0<i.length?o.slideDown(t.view.expandSpeed,a):(o.show(),h.apply(a,[]))):(j.replaceSwitchClass(n,u,g.folder.CLOSE),j.replaceIcoClass(n,c,g.folder.CLOSE),0!=r&&""!=t.view.expandSpeed&&i&&0<i.length?o.slideUp(t.view.expandSpeed,a):(o.hide(),h.apply(a,[])))):h.apply(a,[]))):h.apply(a,[])},expandCollapseParentNode:function(e,t,n,o,r){t&&(t.parentTId?(j.expandCollapseNode(e,t,n,o),t.parentTId&&j.expandCollapseParentNode(e,t.getParentNode(),n,o,r)):j.expandCollapseNode(e,t,n,o,r))},expandCollapseSonNode:function(t,n,o,r,a){var d=e.getRoot(t),d=n?e.nodeChildren(t,n):e.nodeChildren(t,d),i=!n&&r,l=e.getRoot(t).expandTriggerFlag;if(e.getRoot(t).expandTriggerFlag=!1,d)for(var s=0,c=d.length;s<c;s++)d[s]&&j.expandCollapseSonNode(t,d[s],o,i);e.getRoot(t).expandTriggerFlag=l,j.expandCollapseNode(t,n,o,r,a)},isSelectedNode:function(t,n){if(!n)return!1;for(var o=e.getRoot(t).curSelectedList,r=o.length-1;0<=r;r--)if(n===o[r])return!0;return!1},makeDOMNodeIcon:function(t,n,o){var r=e.nodeName(n,o),r=n.view.nameIsHTML?r:r.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");t.push("<span id='",o.tId,g.id.ICON,"' title='' treeNode",g.id.ICON," class='",j.makeNodeIcoClass(n,o),"' style='",j.makeNodeIcoStyle(n,o),"'></span><span id='",o.tId,g.id.SPAN,"' class='",g.className.NAME,"'>",r,"</span>")},makeDOMNodeLine:function(e,t,n){e.push("<span id='",n.tId,g.id.SWITCH,"' title='' class='",j.makeNodeLineClass(t,n),"' treeNode",g.id.SWITCH,"></span>")},makeDOMNodeMainAfter:function(e){e.push("</li>")},makeDOMNodeMainBefore:function(e,t,n){e.push("<li id='",n.tId,"' class='",g.className.LEVEL,n.level,"' tabindex='0' hidefocus='true' treenode>")},makeDOMNodeNameAfter:function(e){e.push("</a>")},makeDOMNodeNameBefore:function(t,n,o){var r,a=e.nodeTitle(n,o),d=j.makeNodeUrl(n,o),i=j.makeNodeFontCss(n,o),l=[];for(r in i)l.push(r,":",i[r],";");t.push("<a id='",o.tId,g.id.A,"' class='",g.className.LEVEL,o.level,"' treeNode",g.id.A,' onclick="',o.click||"",'" ',null!=d&&0<d.length?"href='"+d+"'":""," target='",j.makeNodeTarget(o),"' style='",l.join(""),"'"),h.apply(n.view.showTitle,[n.treeId,o],n.view.showTitle)&&a&&t.push("title='",a.replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),"'"),t.push(">")},makeNodeFontCss:function(e,t){e=h.apply(e.view.fontCss,[e.treeId,t],e.view.fontCss);return e&&"function"!=typeof e?e:{}},makeNodeIcoClass:function(t,n){var o=["ico"];return n.isAjaxing||(t=e.nodeIsParent(t,n),o[0]=(n.iconSkin?n.iconSkin+"_":"")+o[0],t?o.push(n.open?g.folder.OPEN:g.folder.CLOSE):o.push(g.folder.DOCU)),g.className.BUTTON+" "+o.join("_")},makeNodeIcoStyle:function(t,n){var o,r=[];return n.isAjaxing||((o=e.nodeIsParent(t,n)&&n.iconOpen&&n.iconClose?n.open?n.iconOpen:n.iconClose:n[t.data.key.icon])&&r.push("background:url(",o,") 0 0 no-repeat;"),0!=t.view.showIcon&&h.apply(t.view.showIcon,[t.treeId,n],!0)||r.push("width:0px;height:0px;")),r.join("")},makeNodeLineClass:function(t,n){var o=[];return t.view.showLine?0==n.level&&n.isFirstNode&&n.isLastNode?o.push(g.line.ROOT):0==n.level&&n.isFirstNode?o.push(g.line.ROOTS):n.isLastNode?o.push(g.line.BOTTOM):o.push(g.line.CENTER):o.push(g.line.NOLINE),e.nodeIsParent(t,n)?o.push(n.open?g.folder.OPEN:g.folder.CLOSE):o.push(g.folder.DOCU),j.makeNodeLineClassEx(n)+o.join("_")},makeNodeLineClassEx:function(e){return g.className.BUTTON+" "+g.className.LEVEL+e.level+" "+g.className.SWITCH+" "},makeNodeTarget:function(e){return e.target||"_blank"},makeNodeUrl:function(e,t){e=e.data.key.url;return t[e]||null},makeUlHtml:function(e,t,n,o){n.push("<ul id='",t.tId,g.id.UL,"' class='",g.className.LEVEL,t.level," ",j.makeUlLineClass(e,t),"' style='display:",t.open?"block":"none","'>"),n.push(o),n.push("</ul>")},makeUlLineClass:function(e,t){return e.view.showLine&&!t.isLastNode?g.line.LINE:""},removeChildNodes:function(t,n){if(n){var o=e.nodeChildren(t,n);if(o){for(var r=0,a=o.length;r<a;r++)e.removeNodeCache(t,o[r]);e.removeSelectedNode(t),delete n[t.data.key.children],t.data.keep.parent?l(n,g.id.UL,t).empty():(e.nodeIsParent(t,n,!1),n.open=!1,o=l(n,g.id.SWITCH,t),r=l(n,g.id.ICON,t),j.replaceSwitchClass(n,o,g.folder.DOCU),j.replaceIcoClass(n,r,g.folder.DOCU),l(n,g.id.UL,t).remove())}}},scrollIntoView:function(e,t){var n;t&&("undefined"==typeof Element?(n=e.treeObj.get(0).getBoundingClientRect(),((e=t.getBoundingClientRect()).top<n.top||e.bottom>n.bottom||e.right>n.right||e.left<n.left)&&t.scrollIntoView()):(Element.prototype.scrollIntoViewIfNeeded||(Element.prototype.scrollIntoViewIfNeeded=function(n){function e(e,t){return{start:e,length:t,end:e+t}}function t(e,t){return!1===n||t.start<e.end&&e.start<t.end?Math.max(e.end-t.length,Math.min(t.start,e.start)):(e.start+e.end-t.length)/2}function r(n,o){return{x:n,y:o,translate:function(e,t){return r(n+e,o+t)}}}function o(e,t){for(;e;)t=t.translate(e.offsetLeft,e.offsetTop),e=e.offsetParent;return t}for(var a,d=o(this,r(0,0)),i=r(this.offsetWidth,this.offsetHeight),l=this.parentNode;l instanceof HTMLElement;)a=o(l,r(l.clientLeft,l.clientTop)),l.scrollLeft=t(e(d.x-a.x,i.x),e(l.scrollLeft,l.clientWidth)),l.scrollTop=t(e(d.y-a.y,i.y),e(l.scrollTop,l.clientHeight)),d=d.translate(-l.scrollLeft,-l.scrollTop),l=l.parentNode}),t.scrollIntoViewIfNeeded()))},setFirstNode:function(t,n){n=e.nodeChildren(t,n);0<n.length&&(n[0].isFirstNode=!0)},setLastNode:function(t,n){n=e.nodeChildren(t,n);0<n.length&&(n[n.length-1].isLastNode=!0)},removeNode:function(t,n){var o=e.getRoot(t),r=n.parentTId?n.getParentNode():o;if(n.isFirstNode=!1,n.isLastNode=!1,n.getPreNode=function(){return null},n.getNextNode=function(){return null},e.getNodeCache(t,n.tId)){l(n,t).remove(),e.removeNodeCache(t,n),e.removeSelectedNode(t,n);for(var a=e.nodeChildren(t,r),d=0,i=a.length;d<i;d++)if(a[d].tId==n.tId){a.splice(d,1);break}j.setFirstNode(t,r),j.setLastNode(t,r);var s,c,d=a.length;t.data.keep.parent||0!=d?t.view.showLine&&0<d&&(s=a[d-1],d=l(s,g.id.UL,t),i=l(s,g.id.SWITCH,t),c=l(s,g.id.ICON,t),r==o?1==a.length?j.replaceSwitchClass(s,i,g.line.ROOT):(o=l(a[0],g.id.SWITCH,t),j.replaceSwitchClass(a[0],o,g.line.ROOTS),j.replaceSwitchClass(s,i,g.line.BOTTOM)):j.replaceSwitchClass(s,i,g.line.BOTTOM),d.removeClass(g.line.LINE)):(e.nodeIsParent(t,r,!1),r.open=!1,delete r[t.data.key.children],d=l(r,g.id.UL,t),i=l(r,g.id.SWITCH,t),c=l(r,g.id.ICON,t),j.replaceSwitchClass(r,i,g.folder.DOCU),j.replaceIcoClass(r,c,g.folder.DOCU),d.css("display","none"))}},replaceIcoClass:function(e,t,n){if(t&&!e.isAjaxing&&null!=(e=t.attr("class"))){switch(e=e.split("_"),n){case g.folder.OPEN:case g.folder.CLOSE:case g.folder.DOCU:e[e.length-1]=n}t.attr("class",e.join("_"))}},replaceSwitchClass:function(e,t,n){if(t){var o=t.attr("class");if(null!=o){switch(o=o.split("_"),n){case g.line.ROOT:case g.line.ROOTS:case g.line.CENTER:case g.line.BOTTOM:case g.line.NOLINE:o[0]=j.makeNodeLineClassEx(e)+n;break;case g.folder.OPEN:case g.folder.CLOSE:case g.folder.DOCU:o[1]=n}t.attr("class",o.join("_")),n!==g.folder.DOCU?t.removeAttr("disabled"):t.attr("disabled","disabled")}}},selectNode:function(t,n,o){o||j.cancelPreSelectedNode(t,null,n),l(n,g.id.A,t).addClass(g.node.CURSELECTED),e.addSelectedNode(t,n),t.treeObj.trigger(g.event.SELECTED,[t.treeId,n])},setNodeFontCss:function(e,t){var n=l(t,g.id.A,e),t=j.makeNodeFontCss(e,t);t&&n.css(t)},setNodeLineIcos:function(t,n){var o,r,a,d;n&&(o=l(n,g.id.SWITCH,t),r=l(n,g.id.UL,t),a=l(n,g.id.ICON,t),0==(d=j.makeUlLineClass(t,n)).length?r.removeClass(g.line.LINE):r.addClass(d),o.attr("class",j.makeNodeLineClass(t,n)),e.nodeIsParent(t,n)?o.removeAttr("disabled"):o.attr("disabled","disabled"),a.removeAttr("style"),a.attr("style",j.makeNodeIcoStyle(t,n)),a.attr("class",j.makeNodeIcoClass(t,n)))},setNodeName:function(t,n){var o=e.nodeTitle(t,n),r=l(n,g.id.SPAN,t);r.empty(),t.view.nameIsHTML?r.html(e.nodeName(t,n)):r.text(e.nodeName(t,n)),h.apply(t.view.showTitle,[t.treeId,n],t.view.showTitle)&&l(n,g.id.A,t).attr("title",o||"")},setNodeTarget:function(e,t){l(t,g.id.A,e).attr("target",j.makeNodeTarget(t))},setNodeUrl:function(e,t){var n=l(t,g.id.A,e),t=j.makeNodeUrl(e,t);null==t||0==t.length?n.removeAttr("href"):n.attr("href",t)},switchNode:function(e,t){t.open||!h.canAsync(e,t)?j.expandCollapseNode(e,t,!t.open):e.async.enable?j.asyncNode(e,t)||j.expandCollapseNode(e,t,!t.open):t&&j.expandCollapseNode(e,t,!t.open)}};r.fn.zTree={consts:{className:{BUTTON:"button",LEVEL:"level",ICO_LOADING:"ico_loading",SWITCH:"switch",NAME:"node_name"},event:{NODECREATED:"ztree_nodeCreated",CLICK:"ztree_click",EXPAND:"ztree_expand",COLLAPSE:"ztree_collapse",ASYNC_SUCCESS:"ztree_async_success",ASYNC_ERROR:"ztree_async_error",REMOVE:"ztree_remove",SELECTED:"ztree_selected",UNSELECTED:"ztree_unselected"},id:{A:"_a",ICON:"_ico",SPAN:"_span",SWITCH:"_switch",UL:"_ul"},line:{ROOT:"root",ROOTS:"roots",CENTER:"center",BOTTOM:"bottom",NOLINE:"noline",LINE:"line"},folder:{OPEN:"open",CLOSE:"close",DOCU:"docu"},node:{CURSELECTED:"curSelectedNode"}},_z:{tools:h,view:j,event:n,data:e},getZTreeObj:function(t){return(t=e.getZTreeTools(t))?t:null},destroy:function(n){if(n&&0<n.length)j.destroy(e.getSetting(n));else for(var o in t)j.destroy(t[o])},init:function(o,a,d){var s=h.clone(P);r.extend(!0,s,a),s.treeId=o.attr("id"),s.treeObj=o,s.treeObj.empty(),t[s.treeId]=s,void 0===document.body.style.maxHeight&&(s.view.expandSpeed=""),e.initRoot(s),o=e.getRoot(s),d=d?h.clone(h.isArray(d)?d:[d]):[],s.data.simpleData.enable?e.nodeChildren(s,o,e.transformTozTreeFormat(s,d)):e.nodeChildren(s,o,d),e.initCache(s),n.unbindTree(s),n.bindTree(s),n.unbindEvent(s),n.bindEvent(s);var i={setting:s,addNodes:function(t,n,o,r){function a(){j.addNodes(s,t,n,i,1==r)}t=t||null;var d=e.nodeIsParent(s,t);if(t&&!d&&s.data.keep.leaf)return null;if(d=parseInt(n,10),n=isNaN(d)?(r=!!o,o=n,-1):d,!o)return null;var i=h.clone(h.isArray(o)?o:[o]);return h.canAsync(s,t)?j.asyncNode(s,t,r,a):a(),i},cancelSelectedNode:function(e){j.cancelPreSelectedNode(s,e)},destroy:function(){j.destroy(s)},expandAll:function(e){return e=!!e,j.expandCollapseSonNode(s,null,e,!0),e},expandNode:function(t,n,o,r,a){function d(){var e=l(t,s).get(0);e&&!1!==r&&j.scrollIntoView(s,e)}return t&&e.nodeIsParent(s,t)?(!0!==n&&!1!==n&&(n=!t.open),(a=!!a)&&n&&0==h.apply(s.callback.beforeExpand,[s.treeId,t],!0)||a&&!n&&0==h.apply(s.callback.beforeCollapse,[s.treeId,t],!0)?null:(n&&t.parentTId&&j.expandCollapseParentNode(s,t.getParentNode(),n,!1),n!==t.open||o?(e.getRoot(s).expandTriggerFlag=a,!h.canAsync(s,t)&&o?j.expandCollapseSonNode(s,t,n,!0,d):(t.open=!n,j.switchNode(this.setting,t),d()),n):null)):null},getNodes:function(){return e.getNodes(s)},getNodeByParam:function(t,n,o){return t?e.getNodeByParam(s,o?e.nodeChildren(s,o):e.getNodes(s),t,n):null},getNodeByTId:function(t){return e.getNodeCache(s,t)},getNodesByParam:function(t,n,o){return t?e.getNodesByParam(s,o?e.nodeChildren(s,o):e.getNodes(s),t,n):null},getNodesByParamFuzzy:function(t,n,o){return t?e.getNodesByParamFuzzy(s,o?e.nodeChildren(s,o):e.getNodes(s),t,n):null},getNodesByFilter:function(t,n,o,r){return n=!!n,t&&"function"==typeof t?e.getNodesByFilter(s,o?e.nodeChildren(s,o):e.getNodes(s),t,n,r):n?null:[]},getNodeIndex:function(t){if(!t)return null;for(var n=t.parentTId?t.getParentNode():e.getRoot(s),o=0,r=(n=e.nodeChildren(s,n)).length;o<r;o++)if(n[o]==t)return o;return-1},getSelectedNodes:function(){for(var t=[],n=e.getRoot(s).curSelectedList,o=0,r=n.length;o<r;o++)t.push(n[o]);return t},isSelectedNode:function(t){return e.isSelectedNode(s,t)},reAsyncChildNodesPromise:function(n,o,r){return new Promise(function(e,t){try{i.reAsyncChildNodes(n,o,r,function(){e(n)})}catch(e){t(e)}})},reAsyncChildNodes:function(t,n,o,r){if(this.setting.async.enable){var a=!t;if(a&&(t=e.getRoot(s)),"refresh"==n){for(var d=0,i=(n=e.nodeChildren(s,t))?n.length:0;d<i;d++)e.removeNodeCache(s,n[d]);e.removeSelectedNode(s),e.nodeChildren(s,t,[]),(a?this.setting.treeObj:l(t,g.id.UL,s)).empty()}j.asyncNode(this.setting,a?null:t,!!o,r)}},refresh:function(){this.setting.treeObj.empty();var t=e.getRoot(s),n=e.nodeChildren(s,t);e.initRoot(s),e.nodeChildren(s,t,n),e.initCache(s),j.createNodes(s,0,e.nodeChildren(s,t),null,-1)},removeChildNodes:function(t){if(!t)return null;var n=e.nodeChildren(s,t);return j.removeChildNodes(s,t),n||null},removeNode:function(e,t){e&&((t=!!t)&&0==h.apply(s.callback.beforeRemove,[s.treeId,e],!0)||(j.removeNode(s,e),t&&this.setting.treeObj.trigger(g.event.REMOVE,[s.treeId,e])))},selectNode:function(t,e,n){if(t&&h.uCanDo(s)){if(e=s.view.selectedMulti&&e,t.parentTId)j.expandCollapseParentNode(s,t.getParentNode(),!0,!1,function(){var e;n||(e=l(t,s).get(0),j.scrollIntoView(s,e))});else if(!n)try{l(t,s).focus().blur()}catch(e){}j.selectNode(s,t,e)}},transformTozTreeNodes:function(t){return e.transformTozTreeFormat(s,t)},transformToArray:function(t){return e.transformToArrayFormat(s,t)},updateNode:function(e){e&&l(e,s).get(0)&&h.uCanDo(s)&&(j.setNodeName(s,e),j.setNodeTarget(s,e),j.setNodeUrl(s,e),j.setNodeLineIcos(s,e),j.setNodeFontCss(s,e))}};return o.treeTools=i,e.setZTreeTools(s,i),(d=e.nodeChildren(s,o))&&0<d.length?j.createNodes(s,0,d,null,-1):s.async.enable&&s.async.url&&""!==s.async.url&&j.asyncNode(s),i}};var Q=r.fn.zTree,l=h.$,g=Q.consts}(jQuery),function(e){var t={event:{CHECK:"ztree_check"},id:{CHECK:"_check"},checkbox:{STYLE:"checkbox",DEFAULT:"chk",DISABLED:"disable",FALSE:"false",TRUE:"true",FULL:"full",PART:"part",FOCUS:"focus"},radio:{STYLE:"radio",TYPE_ALL:"all",TYPE_LEVEL:"level"}},n={check:{enable:!1,autoCheckTrigger:!1,chkStyle:t.checkbox.STYLE,nocheckInherit:!1,chkDisabledInherit:!1,radioType:t.radio.TYPE_LEVEL,chkboxType:{Y:"ps",N:"ps"}},data:{key:{checked:"checked"}},callback:{beforeCheck:null,onCheck:null}},i=function(e,t){if(!0===t.chkDisabled)return!1;var n=g.getSetting(e.data.treeId);if(0==c.apply(n.callback.beforeCheck,[n.treeId,t],!0))return!0;var o=g.nodeChecked(n,t);return g.nodeChecked(n,t,!o),h.checkNodeRelation(n,t),o=p(t,u.id.CHECK,n),h.setChkClass(n,o,t),h.repairParentChkClassWithSelf(n,t),n.treeObj.trigger(u.event.CHECK,[e,n.treeId,t]),!0},l=function(e,t){if(!0===t.chkDisabled)return!1;var n=g.getSetting(e.data.treeId),e=p(t,u.id.CHECK,n);return t.check_Focus=!0,h.setChkClass(n,e,t),!0},s=function(e,t){if(!0===t.chkDisabled)return!1;var n=g.getSetting(e.data.treeId),e=p(t,u.id.CHECK,n);return t.check_Focus=!1,h.setChkClass(n,e,t),!0};e.extend(!0,e.fn.zTree.consts,t),e.extend(!0,e.fn.zTree._z,{tools:{},view:{checkNodeRelation:function(e,t){var n,o=u.radio,r=g.nodeChecked(e,t);if(e.check.chkStyle==o.STYLE){var a=g.getRadioCheckedList(e);if(r)if(e.check.radioType==o.TYPE_ALL){for(o=a.length-1;0<=o;o--){r=a[o];var d=g.nodeChecked(e,r);d&&r!=t&&(g.nodeChecked(e,r,!1),a.splice(o,1),h.setChkClass(e,p(r,u.id.CHECK,e),r),r.parentTId!=t.parentTId&&h.repairParentChkClassWithSelf(e,r))}a.push(t)}else for(a=t.parentTId?t.getParentNode():g.getRoot(e),o=0,n=(a=g.nodeChildren(e,a)).length;o<n;o++)r=a[o],(d=g.nodeChecked(e,r))&&r!=t&&(g.nodeChecked(e,r,!1),h.setChkClass(e,p(r,u.id.CHECK,e),r));else if(e.check.radioType==o.TYPE_ALL)for(o=0,n=a.length;o<n;o++)if(t==a[o]){a.splice(o,1);break}}else a=g.nodeChildren(e,t),r&&(!a||0==a.length||-1<e.check.chkboxType.Y.indexOf("s"))&&h.setSonNodeCheckBox(e,t,!0),r||a&&0!=a.length&&!(-1<e.check.chkboxType.N.indexOf("s"))||h.setSonNodeCheckBox(e,t,!1),r&&-1<e.check.chkboxType.Y.indexOf("p")&&h.setParentNodeCheckBox(e,t,!0),!r&&-1<e.check.chkboxType.N.indexOf("p")&&h.setParentNodeCheckBox(e,t,!1)},makeChkClass:function(e,t){var n=u.checkbox,o=u.radio,r=g.nodeChecked(e,t),a=!0===t.chkDisabled?n.DISABLED:t.halfCheck?n.PART:e.check.chkStyle!=o.STYLE&&r?2===t.check_Child_State||-1===t.check_Child_State?n.FULL:n.PART:t.check_Child_State<1?n.FULL:n.PART,o=e.check.chkStyle+"_"+(r?n.TRUE:n.FALSE)+"_"+a,o=t.check_Focus&&!0!==t.chkDisabled?o+"_"+n.FOCUS:o;return u.className.BUTTON+" "+n.DEFAULT+" "+o},repairAllChk:function(e,t){if(e.check.enable&&e.check.chkStyle===u.checkbox.STYLE)for(var n=g.getRoot(e),o=0,r=(n=g.nodeChildren(e,n)).length;o<r;o++){var a=n[o];!0!==a.nocheck&&!0!==a.chkDisabled&&g.nodeChecked(e,a,t),h.setSonNodeCheckBox(e,a,t)}},repairChkClass:function(e,t){var n;t&&(g.makeChkFlag(e,t),!0!==t.nocheck)&&(n=p(t,u.id.CHECK,e),h.setChkClass(e,n,t))},repairParentChkClass:function(e,t){t&&t.parentTId&&(t=t.getParentNode(),h.repairChkClass(e,t),h.repairParentChkClass(e,t))},repairParentChkClassWithSelf:function(e,t){var n;t&&((n=g.nodeChildren(e,t))&&0<n.length?h.repairParentChkClass(e,n[0]):h.repairParentChkClass(e,t))},repairSonChkDisabled:function(e,t,n,o){if(t&&(t.chkDisabled!=n&&(t.chkDisabled=n),h.repairChkClass(e,t),(t=g.nodeChildren(e,t))&&o))for(var r=0,a=t.length;r<a;r++)h.repairSonChkDisabled(e,t[r],n,o)},repairParentChkDisabled:function(e,t,n,o){t&&(t.chkDisabled!=n&&o&&(t.chkDisabled=n),h.repairChkClass(e,t),h.repairParentChkDisabled(e,t.getParentNode(),n,o))},setChkClass:function(e,t,n){t&&(!0===n.nocheck?t.hide():t.show(),t.attr("class",h.makeChkClass(e,n)))},setParentNodeCheckBox:function(e,t,n,o){var r=p(t,u.id.CHECK,e);if(o=o||t,g.makeChkFlag(e,t),!0!==t.nocheck&&!0!==t.chkDisabled&&(g.nodeChecked(e,t,n),h.setChkClass(e,r,t),e.check.autoCheckTrigger&&t!=o&&e.treeObj.trigger(u.event.CHECK,[null,e.treeId,t])),t.parentTId){if(r=!0,!n)for(var a=g.nodeChildren(e,t.getParentNode()),d=0,i=a.length;d<i;d++){var l=a[d],s=g.nodeChecked(e,l);if(!0!==l.nocheck&&!0!==l.chkDisabled&&s||(!0===l.nocheck||!0===l.chkDisabled)&&0<l.check_Child_State){r=!1;break}}r&&h.setParentNodeCheckBox(e,t.getParentNode(),n,o)}},setSonNodeCheckBox:function(e,t,n,o){if(t){var r=p(t,u.id.CHECK,e);o=o||t;var a=!1,d=g.nodeChildren(e,t);if(d)for(var i=0,l=d.length;i<l;i++){var s=d[i];h.setSonNodeCheckBox(e,s,n,o),!0===s.chkDisabled&&(a=!0)}t!=g.getRoot(e)&&!0!==t.chkDisabled&&(a&&!0!==t.nocheck&&g.makeChkFlag(e,t),!0!==t.nocheck&&!0!==t.chkDisabled?(g.nodeChecked(e,t,n),a||(t.check_Child_State=d&&0<d.length?n?2:0:-1)):t.check_Child_State=-1,h.setChkClass(e,r,t),e.check.autoCheckTrigger&&t!=o&&!0!==t.nocheck&&!0!==t.chkDisabled&&e.treeObj.trigger(u.event.CHECK,[null,e.treeId,t]))}}},event:{},data:{getRadioCheckedList:function(e){for(var t=g.getRoot(e).radioCheckedList,n=0,o=t.length;n<o;n++)g.getNodeCache(e,t[n].tId)||(t.splice(n,1),n--,o--);return t},getCheckStatus:function(e,t){if(!e.check.enable||t.nocheck||t.chkDisabled)return null;var n=g.nodeChecked(e,t);return{checked:n,half:t.halfCheck||(e.check.chkStyle==u.radio.STYLE?2===t.check_Child_State:n?-1<t.check_Child_State&&t.check_Child_State<2:0<t.check_Child_State)}},getTreeCheckedNodes:function(e,t,n,o){if(!t)return[];for(var r=n&&e.check.chkStyle==u.radio.STYLE&&e.check.radioType==u.radio.TYPE_ALL,o=o||[],a=0,d=t.length;a<d;a++){var i=t[a],l=g.nodeChildren(e,i),s=g.nodeChecked(e,i);if(!0!==i.nocheck&&!0!==i.chkDisabled&&s==n&&(o.push(i),r))break;if(g.getTreeCheckedNodes(e,l,n,o),r&&0<o.length)break}return o},getTreeChangeCheckedNodes:function(e,t,n){if(!t)return[];for(var n=n||[],o=0,r=t.length;o<r;o++){var a=t[o],d=g.nodeChildren(e,a),i=g.nodeChecked(e,a);!0!==a.nocheck&&!0!==a.chkDisabled&&i!=a.checkedOld&&n.push(a),g.getTreeChangeCheckedNodes(e,d,n)}return n},makeChkFlag:function(e,t){if(t){var n=-1,o=g.nodeChildren(e,t);if(o)for(var r=0,a=o.length;r<a;r++){var d=o[r],i=g.nodeChecked(e,d),l=-1;if(e.check.chkStyle==u.radio.STYLE){if(2==(l=!0===d.nocheck||!0===d.chkDisabled?d.check_Child_State:!0===d.halfCheck||i||0<d.check_Child_State?2:0)){n=2;break}0==l&&(n=0)}else if(e.check.chkStyle==u.checkbox.STYLE){if(1===(l=!0===d.nocheck||!0===d.chkDisabled?d.check_Child_State:!0===d.halfCheck?1:i?-1===d.check_Child_State||2===d.check_Child_State?2:1:0<d.check_Child_State?1:0)){n=1;break}if(2===l&&-1<n&&0<r&&l!==n){n=1;break}if(2===n&&-1<l&&l<2){n=1;break}-1<l&&(n=l)}}t.check_Child_State=n}}}});var c=(e=e.fn.zTree)._z.tools,u=e.consts,h=e._z.view,g=e._z.data,p=c.$;g.nodeChecked=function(e,t,n){return!!t&&(e=e.data.key.checked,void 0!==n?("string"==typeof n&&(n=c.eqs(n,"true")),t[e]=!!n):t[e]="string"==typeof t[e]?c.eqs(t[e],"true"):!!t[e],t[e])},g.exSetting(n),g.addInitBind(function(r){r.treeObj.bind(u.event.CHECK,function(e,t,n,o){e.srcEvent=t,c.apply(r.callback.onCheck,[e,n,o])})}),g.addInitUnBind(function(e){e.treeObj.unbind(u.event.CHECK)}),g.addInitCache(function(){}),g.addInitNode(function(e,t,n,o){n&&(t=g.nodeChecked(e,n),n.checkedOld=t,"string"==typeof n.nocheck&&(n.nocheck=c.eqs(n.nocheck,"true")),n.nocheck=!!n.nocheck||e.check.nocheckInherit&&o&&!!o.nocheck,"string"==typeof n.chkDisabled&&(n.chkDisabled=c.eqs(n.chkDisabled,"true")),n.chkDisabled=!!n.chkDisabled||e.check.chkDisabledInherit&&o&&!!o.chkDisabled,"string"==typeof n.halfCheck&&(n.halfCheck=c.eqs(n.halfCheck,"true")),n.halfCheck=!!n.halfCheck,n.check_Child_State=-1,n.check_Focus=!1,n.getCheckStatus=function(){return g.getCheckStatus(e,n)},e.check.chkStyle==u.radio.STYLE&&e.check.radioType==u.radio.TYPE_ALL&&t&&g.getRoot(e).radioCheckedList.push(n))}),g.addInitProxy(function(e){var t=e.target,n=g.getSetting(e.data.treeId),o="",r=null,a="",d=null;if(c.eqs(e.type,"mouseover")?n.check.enable&&c.eqs(t.tagName,"span")&&null!==t.getAttribute("treeNode"+u.id.CHECK)&&(o=c.getNodeMainDom(t).id,a="mouseoverCheck"):c.eqs(e.type,"mouseout")?n.check.enable&&c.eqs(t.tagName,"span")&&null!==t.getAttribute("treeNode"+u.id.CHECK)&&(o=c.getNodeMainDom(t).id,a="mouseoutCheck"):c.eqs(e.type,"click")&&n.check.enable&&c.eqs(t.tagName,"span")&&null!==t.getAttribute("treeNode"+u.id.CHECK)&&(o=c.getNodeMainDom(t).id,a="checkNode"),0<o.length)switch(r=g.getNodeCache(n,o),a){case"checkNode":d=i;break;case"mouseoverCheck":d=l;break;case"mouseoutCheck":d=s}return{stop:"checkNode"===a,node:r,nodeEventType:a,nodeEventCallback:d,treeEventType:"",treeEventCallback:null}},!0),g.addInitRoot(function(e){g.getRoot(e).radioCheckedList=[]}),g.addBeforeA(function(e,t,n){e.check.enable&&(g.makeChkFlag(e,t),n.push("<span ID='",t.tId,u.id.CHECK,"' class='",h.makeChkClass(e,t),"' treeNode",u.id.CHECK,!0===t.nocheck?" style='display:none;'":"","></span>"))}),g.addZTreeTools(function(a,o){o.checkNode=function(e,t,n,o){var r=g.nodeChecked(a,e);!0===e.chkDisabled||(!0!==t&&!1!==t&&(t=!r),o=!!o,r===t&&!n||o&&0==c.apply(this.setting.callback.beforeCheck,[this.setting.treeId,e],!0)||!c.uCanDo(this.setting)||!this.setting.check.enable||!0===e.nocheck)||(g.nodeChecked(a,e,t),t=p(e,u.id.CHECK,this.setting),!n&&this.setting.check.chkStyle!==u.radio.STYLE||h.checkNodeRelation(this.setting,e),h.setChkClass(this.setting,t,e),h.repairParentChkClassWithSelf(this.setting,e),o&&this.setting.treeObj.trigger(u.event.CHECK,[null,this.setting.treeId,e]))},o.checkAllNodes=function(e){h.repairAllChk(this.setting,!!e)},o.getCheckedNodes=function(e){var e=!1!==e,t=g.nodeChildren(a,g.getRoot(this.setting));return g.getTreeCheckedNodes(this.setting,t,e)},o.getChangeCheckedNodes=function(){var e=g.nodeChildren(a,g.getRoot(this.setting));return g.getTreeChangeCheckedNodes(this.setting,e)},o.setChkDisabled=function(e,t,n,o){t=!!t,n=!!n,h.repairSonChkDisabled(this.setting,e,t,!!o),h.repairParentChkDisabled(this.setting,e.getParentNode(),t,n)};var r=o.updateNode;o.updateNode=function(e,t){var n;r&&r.apply(o,arguments),e&&this.setting.check.enable&&p(e,this.setting).get(0)&&c.uCanDo(this.setting)&&(n=p(e,u.id.CHECK,this.setting),1!=t&&this.setting.check.chkStyle!==u.radio.STYLE||h.checkNodeRelation(this.setting,e),h.setChkClass(this.setting,n,e),h.repairParentChkClassWithSelf(this.setting,e))}});var a=h.createNodes;h.createNodes=function(e,t,n,o,r){a&&a.apply(h,arguments),n&&h.repairParentChkClassWithSelf(e,o)};var o=h.removeNode;h.removeNode=function(e,t){var n=t.getParentNode();o&&o.apply(h,arguments),t&&n&&(h.repairChkClass(e,n),h.repairParentChkClass(e,n))};var f=h.appendNodes;h.appendNodes=function(e,t,n,o,r,a,d){var i="";return f&&(i=f.apply(h,arguments)),o&&g.makeChkFlag(e,o),i}}(jQuery),function(F){var B={event:{DRAG:"ztree_drag",DROP:"ztree_drop",RENAME:"ztree_rename",DRAGMOVE:"ztree_dragmove"},id:{EDIT:"_edit",INPUT:"_input",REMOVE:"_remove"},move:{TYPE_INNER:"inner",TYPE_PREV:"prev",TYPE_NEXT:"next"},node:{CURSELECTED_EDIT:"curSelectedNode_Edit",TMPTARGET_TREE:"tmpTargetzTree",TMPTARGET_NODE:"tmpTargetNode"}},s={onHoverOverNode:function(e,t){var n=K.getSetting(e.data.treeId),o=K.getRoot(n);o.curHoverNode!=t&&s.onHoverOutNode(e),o.curHoverNode=t,Y.addHoverDom(n,t)},onHoverOutNode:function(e){var e=K.getSetting(e.data.treeId),t=K.getRoot(e);t.curHoverNode&&!K.isSelectedNode(e,t.curHoverNode)&&(Y.removeTreeDom(e,t.curHoverNode),t.curHoverNode=null)},onMousedownNode:function(e,t){function i(e){if(0==k.dragFlag&&Math.abs(A-e.clientX)<m.edit.drag.minMoveSize&&Math.abs(M-e.clientY)<m.edit.drag.minMoveSize)return!0;var t;if(D.css("cursor","pointer"),0==k.dragFlag){if(0==H.apply(m.callback.beforeDrag,[m.treeId,b],!0))return v(e),!0;for(r=0,a=b.length;r<a;r++)0==r&&(k.dragNodeShowBefore=[]),o=b[r],K.nodeIsParent(m,o)&&o.open?(Y.expandCollapseNode(m,o,!o.open),k.dragNodeShowBefore[o.tId]=!0):k.dragNodeShowBefore[o.tId]=!1;k.dragFlag=1,T.showHoverDom=!1,H.showIfameMask(m,!0),t=!0;var n=-1;if(1<b.length)for(var o=[],r=0,a=(u=b[0].parentTId?K.nodeChildren(m,b[0].getParentNode()):K.getNodes(m)).length;r<a;r++)if(void 0!==k.dragNodeShowBefore[u[r].tId]&&(t&&-1<n&&n+1!==r&&(t=!1),o.push(u[r]),n=r),b.length===o.length){b=o;break}for(t&&(S=b[0].getPreNode(),P=b[b.length-1].getNextNode()),E=V("<ul class='zTreeDragUL'></ul>",m),r=0,a=b.length;r<a;r++)(o=b[r]).editNameFlag=!1,Y.selectNode(m,o,0<r),Y.removeTreeDom(m,o),r>m.edit.drag.maxShowNodeNum-1||((t=V("<li id='"+o.tId+"_tmp'></li>",m)).append(V(o,z.id.A,m).clone()),t.css("padding","0"),t.children("#"+o.tId+z.id.A).removeClass(z.node.CURSELECTED),E.append(t),r==m.edit.drag.maxShowNodeNum-1&&(t=V("<li id='"+o.tId+"_moretmp'><a>  ...  </a></li>",m),E.append(t)));E.attr("id",b[0].tId+z.id.UL+"_tmp"),E.addClass(m.treeObj.attr("class")),E.appendTo(D),(I=V("<span class='tmpzTreeMove_arrow'></span>",m)).attr("id","zTreeMove_arrow_tmp"),I.appendTo(D),m.treeObj.trigger(z.event.DRAG,[e,m.treeId,b])}if(1==k.dragFlag){for(var d in y&&I.attr("id")==e.target.id&&_&&e.clientX+O.scrollLeft()+2>F("#"+_+z.id.A,y).offset().left?(o=F("#"+_+z.id.A,y),e.target=0<o.length?o.get(0):e.target):y&&(y.removeClass(z.node.TMPTARGET_TREE),_&&F("#"+_+z.id.A,y).removeClass(z.node.TMPTARGET_NODE+"_"+z.move.TYPE_PREV).removeClass(z.node.TMPTARGET_NODE+"_"+B.move.TYPE_NEXT).removeClass(z.node.TMPTARGET_NODE+"_"+B.move.TYPE_INNER)),_=y=null,R=!1,L=m,o=K.getSettings())o[d].treeId&&o[d].edit.enable&&o[d].treeId!=m.treeId&&(e.target.id==o[d].treeId||0<F(e.target).parents("#"+o[d].treeId).length)&&(R=!0,L=o[d]);d=O.scrollTop(),t=O.scrollLeft(),n=L.treeObj.offset(),r=L.treeObj.get(0).scrollHeight,o=L.treeObj.get(0).scrollWidth,a=e.clientY+d-n.top;var i,l=L.treeObj.height()+n.top-e.clientY-d,s=e.clientX+t-n.left,c=L.treeObj.width()+n.left-e.clientX-t,n=a<m.edit.drag.borderMax&&a>m.edit.drag.borderMin,u=l<m.edit.drag.borderMax&&l>m.edit.drag.borderMin,h=s<m.edit.drag.borderMax&&s>m.edit.drag.borderMin,g=c<m.edit.drag.borderMax&&c>m.edit.drag.borderMin,l=a>m.edit.drag.borderMin&&l>m.edit.drag.borderMin&&s>m.edit.drag.borderMin&&c>m.edit.drag.borderMin,s=n&&L.treeObj.scrollTop()<=0,c=u&&L.treeObj.scrollTop()+L.treeObj.height()+10>=r,p=h&&L.treeObj.scrollLeft()<=0,f=g&&L.treeObj.scrollLeft()+L.treeObj.width()+10>=o;if(e.target&&H.isChildOrSelf(e.target,L.treeId)){for(var N=e.target;N&&N.tagName&&!H.eqs(N.tagName,"li")&&N.id!=L.treeId;)N=N.parentNode;var C=!0;for(r=0,a=b.length;r<a;r++){if(o=b[r],N.id===o.tId){C=!1;break}if(0<V(o,m).find("#"+N.id).length){C=!1;break}}C&&e.target&&H.isChildOrSelf(e.target,N.id+z.id.A)&&(y=F(N),_=N.id)}o=b[0],l&&H.isChildOrSelf(e.target,L.treeId)&&(!y&&(e.target.id==L.treeId||s||c||p||f)&&(R||!R&&o.parentTId)&&(y=L.treeObj),n?L.treeObj.scrollTop(L.treeObj.scrollTop()-10):u&&L.treeObj.scrollTop(L.treeObj.scrollTop()+10),h?L.treeObj.scrollLeft(L.treeObj.scrollLeft()-10):g&&L.treeObj.scrollLeft(L.treeObj.scrollLeft()+10),y&&y!=L.treeObj&&y.offset().left<L.treeObj.offset().left&&L.treeObj.scrollLeft(L.treeObj.scrollLeft()+y.offset().left-L.treeObj.offset().left)),E.css({top:e.clientY+d+3+"px",left:e.clientX+t+3+"px"}),r=t=0,y&&y.attr("id")!=L.treeId?(i=null==_?null:K.getNodeCache(L,_),n=(e.ctrlKey||e.metaKey)&&m.edit.drag.isMove&&m.edit.drag.isCopy||!m.edit.drag.isMove&&m.edit.drag.isCopy,a=!(!S||_!==S.tId),h=!(!P||_!==P.tId),u=o.parentTId&&o.parentTId==_,o=(n||!h)&&H.apply(L.edit.drag.prev,[L.treeId,b,i],!!L.edit.drag.prev),a=(n||!a)&&H.apply(L.edit.drag.next,[L.treeId,b,i],!!L.edit.drag.next),n=(n||!u)&&!(L.data.keep.leaf&&!K.nodeIsParent(m,i))&&H.apply(L.edit.drag.inner,[L.treeId,b,i],!!L.edit.drag.inner),u=function(){y=null,_="",x=z.move.TYPE_INNER,I.css({display:"none"}),window.zTreeMoveTimer&&(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null)},o||a||n?(h=F("#"+_+z.id.A,y),g=i.isLastNode?null:F("#"+i.getNextNode().tId+z.id.A,y.next()),l=h.offset().top,s=h.offset().left,c=o?n?.25:a?.5:1:-1,p=a?n?.75:o?.5:0:-1,d=(e.clientY+d-l)/h.height(),(1==c||d<=c&&-.2<=d)&&o?(t=1-I.width(),r=l-I.height()/2,x=z.move.TYPE_PREV):(0==p||p<=d&&d<=1.2)&&a?(t=1-I.width(),r=null==g||K.nodeIsParent(m,i)&&i.open?l+h.height()-I.height()/2:g.offset().top-I.height()/2,x=z.move.TYPE_NEXT):n?(t=5-I.width(),r=l,x=z.move.TYPE_INNER):u(),y&&(I.css({display:"block",top:r+"px",left:s+t+"px"}),h.addClass(z.node.TMPTARGET_NODE+"_"+x),j==_&&w==x||(U=(new Date).getTime()),i&&K.nodeIsParent(m,i)&&x==z.move.TYPE_INNER&&(d=!0,window.zTreeMoveTimer&&window.zTreeMoveTargetNodeTId!==i.tId?(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null):window.zTreeMoveTimer&&window.zTreeMoveTargetNodeTId===i.tId&&(d=!1),d)&&(window.zTreeMoveTimer=setTimeout(function(){x==z.move.TYPE_INNER&&i&&K.nodeIsParent(m,i)&&!i.open&&(new Date).getTime()-U>L.edit.drag.autoOpenTime&&H.apply(L.callback.beforeDragOpen,[L.treeId,i],!0)&&(Y.switchNode(L,i),L.edit.drag.autoExpandTrigger&&L.treeObj.trigger(z.event.EXPAND,[L.treeId,i]))},L.edit.drag.autoOpenTime+50),window.zTreeMoveTargetNodeTId=i.tId))):u()):(x=z.move.TYPE_INNER,y&&H.apply(L.edit.drag.inner,[L.treeId,b,null],!!L.edit.drag.inner)?y.addClass(z.node.TMPTARGET_TREE):y=null,I.css({display:"none"}),window.zTreeMoveTimer&&(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null)),j=_,w=x,m.treeObj.trigger(z.event.DRAGMOVE,[e,m.treeId,b])}return!1}function v(n){if(window.zTreeMoveTimer&&(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null),w=j=null,O.unbind("mousemove",i),O.unbind("mouseup",v),O.unbind("selectstart",l),D.css("cursor",""),y&&(y.removeClass(z.node.TMPTARGET_TREE),_&&F("#"+_+z.id.A,y).removeClass(z.node.TMPTARGET_NODE+"_"+z.move.TYPE_PREV).removeClass(z.node.TMPTARGET_NODE+"_"+B.move.TYPE_NEXT).removeClass(z.node.TMPTARGET_NODE+"_"+B.move.TYPE_INNER)),H.showIfameMask(m,!1),T.showHoverDom=!0,0!=k.dragFlag){var e,t;for(a=k.dragFlag=0,e=b.length;a<e;a++)t=b[a],K.nodeIsParent(m,t)&&k.dragNodeShowBefore[t.tId]&&!t.open&&(Y.expandCollapseNode(m,t,!t.open),delete k.dragNodeShowBefore[t.tId]);E&&E.remove(),I&&I.remove();var o,r,a,d=(n.ctrlKey||n.metaKey)&&m.edit.drag.isMove&&m.edit.drag.isCopy||!m.edit.drag.isMove&&m.edit.drag.isCopy;!d&&y&&_&&b[0].parentTId&&_==b[0].parentTId&&x==z.move.TYPE_INNER&&(y=null),y?(o=null==_?null:K.getNodeCache(L,_),0==H.apply(m.callback.beforeDrop,[L.treeId,b,o,x,d],!0)?Y.selectNodes(s,b):(r=d?H.clone(b):b,a=function(){if(R){if(!d)for(var e=0,t=b.length;e<t;e++)Y.removeNode(m,b[e]);x==z.move.TYPE_INNER?Y.addNodes(L,o,-1,r):Y.addNodes(L,o.getParentNode(),x==z.move.TYPE_PREV?o.getIndex():o.getIndex()+1,r)}else if(d&&x==z.move.TYPE_INNER)Y.addNodes(L,o,-1,r);else if(d)Y.addNodes(L,o.getParentNode(),x==z.move.TYPE_PREV?o.getIndex():o.getIndex()+1,r);else if(x!=z.move.TYPE_NEXT)for(e=0,t=r.length;e<t;e++)Y.moveNode(L,o,r[e],x,!1);else for(e=-1,t=r.length-1;e<t;t--)Y.moveNode(L,o,r[t],x,!1);Y.selectNodes(L,r),e=V(r[0],m).get(0),Y.scrollIntoView(m,e),m.treeObj.trigger(z.event.DROP,[n,L.treeId,r,o,x,d])},x==z.move.TYPE_INNER&&H.canAsync(L,o)?Y.asyncNode(L,o,!1,a):a())):(Y.selectNodes(s,b),m.treeObj.trigger(z.event.DROP,[n,m.treeId,b,null,null,null]))}}function l(){return!1}var n,o,m=K.getSetting(e.data.treeId),k=K.getRoot(m),T=K.getRoots();if(2==e.button||!m.edit.enable||!m.edit.drag.isCopy&&!m.edit.drag.isMove)return!0;var r=e.target,a=K.getRoot(m).curSelectedList,b=[];if(K.isSelectedNode(m,t))for(n=0,o=a.length;n<o;n++){if(a[n].editNameFlag&&H.eqs(r.tagName,"input")&&null!==r.getAttribute("treeNode"+z.id.INPUT))return!0;if(b.push(a[n]),b[0].parentTId!==a[n].parentTId){b=[t];break}}else b=[t];Y.editNodeBlur=!0,Y.cancelCurEditNode(m);var E,I,y,S,P,O=F(m.treeObj.get(0).ownerDocument),D=F(m.treeObj.get(0).ownerDocument.body),R=!1,L=m,s=m,j=null,w=null,_=null,x=z.move.TYPE_INNER,A=e.clientX,M=e.clientY,U=(new Date).getTime();return H.uCanDo(m)&&O.bind("mousemove",i),O.bind("mouseup",v),O.bind("selectstart",l),!0}};F.extend(!0,F.fn.zTree.consts,B),F.extend(!0,F.fn.zTree._z,{tools:{getAbs:function(e){return[(e=e.getBoundingClientRect()).left+(document.body.scrollLeft+document.documentElement.scrollLeft),e.top+(document.body.scrollTop+document.documentElement.scrollTop)]},inputFocus:function(e){e.get(0)&&(e.focus(),H.setCursorPosition(e.get(0),e.val().length))},inputSelect:function(e){e.get(0)&&(e.focus(),e.select())},setCursorPosition:function(e,t){e.setSelectionRange?(e.focus(),e.setSelectionRange(t,t)):e.createTextRange&&((e=e.createTextRange()).collapse(!0),e.moveEnd("character",t),e.moveStart("character",t),e.select())},showIfameMask:function(e,t){for(var n=K.getRoot(e);0<n.dragMaskList.length;)n.dragMaskList[0].remove(),n.dragMaskList.shift();if(t)for(var o=V("iframe",e),r=0,a=o.length;r<a;r++){var d=o.get(r),i=H.getAbs(d);(d=V("<div id='zTreeMask_"+r+"' class='zTreeMask' style='top:"+i[1]+"px; left:"+i[0]+"px; width:"+d.offsetWidth+"px; height:"+d.offsetHeight+"px;'></div>",e)).appendTo(V("body",e)),n.dragMaskList.push(d)}}},view:{addEditBtn:function(e,t){var n,o;t.editNameFlag||0<V(t,z.id.EDIT,e).length||!H.apply(e.edit.showRenameBtn,[e.treeId,t],e.edit.showRenameBtn)||(n=V(t,z.id.A,e),o="<span class='"+z.className.BUTTON+" edit' id='"+t.tId+z.id.EDIT+"' title='"+H.apply(e.edit.renameTitle,[e.treeId,t],e.edit.renameTitle)+"' treeNode"+z.id.EDIT+" style='display:none;'></span>",n.append(o),V(t,z.id.EDIT,e).bind("click",function(){return H.uCanDo(e)&&0!=H.apply(e.callback.beforeEditName,[e.treeId,t],!0)&&Y.editNode(e,t),!1}).show())},addRemoveBtn:function(e,t){var n,o;t.editNameFlag||0<V(t,z.id.REMOVE,e).length||!H.apply(e.edit.showRemoveBtn,[e.treeId,t],e.edit.showRemoveBtn)||(n=V(t,z.id.A,e),o="<span class='"+z.className.BUTTON+" remove' id='"+t.tId+z.id.REMOVE+"' title='"+H.apply(e.edit.removeTitle,[e.treeId,t],e.edit.removeTitle)+"' treeNode"+z.id.REMOVE+" style='display:none;'></span>",n.append(o),V(t,z.id.REMOVE,e).bind("click",function(){return H.uCanDo(e)&&0!=H.apply(e.callback.beforeRemove,[e.treeId,t],!0)&&(Y.removeNode(e,t),e.treeObj.trigger(z.event.REMOVE,[e.treeId,t])),!1}).bind("mousedown",function(){return!0}).show())},addHoverDom:function(e,t){K.getRoots().showHoverDom&&(t.isHover=!0,e.edit.enable&&(Y.addEditBtn(e,t),Y.addRemoveBtn(e,t)),H.apply(e.view.addHoverDom,[e.treeId,t]))},cancelCurEditNode:function(e,t,n){var o=K.getRoot(e),r=o.curEditNode;if(r){var a=o.curEditInput,t=t||(n?K.nodeName(e,r):a.val());if(!1===H.apply(e.callback.beforeRename,[e.treeId,r,t,n],!0))return!1;K.nodeName(e,r,t),V(r,z.id.A,e).removeClass(z.node.CURSELECTED_EDIT),a.unbind(),Y.setNodeName(e,r),r.editNameFlag=!1,o.curEditNode=null,o.curEditInput=null,Y.selectNode(e,r,!1),e.treeObj.trigger(z.event.RENAME,[e.treeId,r,n])}return o.noSelection=!0},editNode:function(t,e){var n,o=K.getRoot(t);Y.editNodeBlur=!1,K.isSelectedNode(t,e)&&o.curEditNode==e&&e.editNameFlag?setTimeout(function(){H.inputFocus(o.curEditInput)},0):(e.editNameFlag=!0,Y.removeTreeDom(t,e),Y.cancelCurEditNode(t),Y.selectNode(t,e,!1),V(e,z.id.SPAN,t).html("<input type=text class='rename' id='"+e.tId+z.id.INPUT+"' treeNode"+z.id.INPUT+" >"),(n=V(e,z.id.INPUT,t)).attr("value",K.nodeName(t,e)),t.edit.editNameSelectAll?H.inputSelect(n):H.inputFocus(n),n.bind("blur",function(){Y.editNodeBlur||Y.cancelCurEditNode(t)}).bind("keydown",function(e){"13"==e.keyCode?(Y.editNodeBlur=!0,Y.cancelCurEditNode(t)):"27"==e.keyCode&&Y.cancelCurEditNode(t,null,!0)}).bind("click",function(){return!1}).bind("dblclick",function(){return!1}),V(e,z.id.A,t).addClass(z.node.CURSELECTED_EDIT),o.curEditInput=n,o.noSelection=!1,o.curEditNode=e)},moveNode:function(e,t,n,o,r,a){var d=K.getRoot(e);if(t!=n&&(!e.data.keep.leaf||!t||K.nodeIsParent(e,t)||o!=z.move.TYPE_INNER)){var i,l,s=n.parentTId?n.getParentNode():d;(h=null===t||t==d)&&null===t&&(t=d),h&&(o=z.move.TYPE_INNER),d=t.parentTId?t.getParentNode():d,o!=z.move.TYPE_PREV&&o!=z.move.TYPE_NEXT&&(o=z.move.TYPE_INNER),o==z.move.TYPE_INNER&&(h?n.parentTId=null:(K.nodeIsParent(e,t)||(K.nodeIsParent(e,t,!0),t.open=!!t.open,Y.setNodeLineIcos(e,t)),n.parentTId=t.tId)),i=h?h=e.treeObj:(a||o!=z.move.TYPE_INNER?a||Y.expandCollapseNode(e,t.getParentNode(),!0,!1):Y.expandCollapseNode(e,t,!0,!1),h=V(t,e),i=V(t,z.id.UL,e),h.get(0)&&!i.get(0)&&(i=[],Y.makeUlHtml(e,t,i,""),h.append(i.join(""))),V(t,z.id.UL,e)),(c=V(n,e)).get(0)?h.get(0)||c.remove():c=Y.appendNodes(e,n.level,[n],null,-1,!1,!0).join(""),i.get(0)&&o==z.move.TYPE_INNER?i.append(c):h.get(0)&&o==z.move.TYPE_PREV?h.before(c):h.get(0)&&o==z.move.TYPE_NEXT&&h.after(c),i=-1;var c=0,u=null,h=null,g=n.level,p=K.nodeChildren(e,s),f=K.nodeChildren(e,d),N=K.nodeChildren(e,t);if(n.isFirstNode)i=0,1<p.length&&((u=p[1]).isFirstNode=!0);else if(n.isLastNode)(u=p[(i=p.length-1)-1]).isLastNode=!0;else for(d=0,l=p.length;d<l;d++)if(p[d].tId==n.tId){i=d;break}if(0<=i&&p.splice(i,1),o!=z.move.TYPE_INNER)for(d=0,l=f.length;d<l;d++)f[d].tId==t.tId&&(c=d);o==z.move.TYPE_INNER?(0<(N=N||K.nodeChildren(e,t,[])).length&&((h=N[N.length-1]).isLastNode=!1),N.splice(N.length,0,n),n.isLastNode=!0,n.isFirstNode=1==N.length):t.isFirstNode&&o==z.move.TYPE_PREV?(f.splice(c,0,n),(h=t).isFirstNode=!1,n.parentTId=t.parentTId,n.isFirstNode=!0,n.isLastNode=!1):t.isLastNode&&o==z.move.TYPE_NEXT?(f.splice(c+1,0,n),(h=t).isLastNode=!1,n.parentTId=t.parentTId,n.isFirstNode=!1,n.isLastNode=!0):(o==z.move.TYPE_PREV?f.splice(c,0,n):f.splice(c+1,0,n),n.parentTId=t.parentTId,n.isFirstNode=!1,n.isLastNode=!1),K.fixPIdKeyValue(e,n),K.setSonNodeLevel(e,n.getParentNode(),n),Y.setNodeLineIcos(e,n),Y.repairNodeLevelClass(e,n,g),!e.data.keep.parent&&p.length<1?(K.nodeIsParent(e,s,!1),s.open=!1,t=V(s,z.id.UL,e),o=V(s,z.id.SWITCH,e),d=V(s,z.id.ICON,e),Y.replaceSwitchClass(s,o,z.folder.DOCU),Y.replaceIcoClass(s,d,z.folder.DOCU),t.css("display","none")):u&&Y.setNodeLineIcos(e,u),h&&Y.setNodeLineIcos(e,h),e.check&&e.check.enable&&Y.repairChkClass&&(Y.repairChkClass(e,s),Y.repairParentChkClassWithSelf(e,s),s!=n.parent&&Y.repairParentChkClassWithSelf(e,n)),a||Y.expandCollapseParentNode(e,n.getParentNode(),!0,r)}},removeEditBtn:function(e,t){V(t,z.id.EDIT,e).unbind().remove()},removeRemoveBtn:function(e,t){V(t,z.id.REMOVE,e).unbind().remove()},removeTreeDom:function(e,t){t.isHover=!1,Y.removeEditBtn(e,t),Y.removeRemoveBtn(e,t),H.apply(e.view.removeHoverDom,[e.treeId,t])},repairNodeLevelClass:function(e,t,n){var o,r;n!==t.level&&(o=V(t,e),r=V(t,z.id.A,e),e=V(t,z.id.UL,e),n=z.className.LEVEL+n,t=z.className.LEVEL+t.level,o.removeClass(n),o.addClass(t),r.removeClass(n),r.addClass(t),e.removeClass(n),e.addClass(t))},selectNodes:function(e,t){for(var n=0,o=t.length;n<o;n++)Y.selectNode(e,t[n],0<n)}},event:{},data:{setSonNodeLevel:function(e,t,n){if(n){var o=K.nodeChildren(e,n);if(n.level=t?t.level+1:0,o)for(var t=0,r=o.length;t<r;t++)o[t]&&K.setSonNodeLevel(e,n,o[t])}}}});var e=F.fn.zTree,H=e._z.tools,z=e.consts,Y=e._z.view,K=e._z.data,V=H.$;K.exSetting({edit:{enable:!1,editNameSelectAll:!1,showRemoveBtn:!0,showRenameBtn:!0,removeTitle:"remove",renameTitle:"rename",drag:{autoExpandTrigger:!1,isCopy:!0,isMove:!0,prev:!0,next:!0,inner:!0,minMoveSize:5,borderMax:10,borderMin:-5,maxShowNodeNum:5,autoOpenTime:500}},view:{addHoverDom:null,removeHoverDom:null},callback:{beforeDrag:null,beforeDragOpen:null,beforeDrop:null,beforeEditName:null,beforeRename:null,onDrag:null,onDragMove:null,onDrop:null,onRename:null}}),K.addInitBind(function(i){var e=i.treeObj,t=z.event;e.bind(t.RENAME,function(e,t,n,o){H.apply(i.callback.onRename,[e,t,n,o])}),e.bind(t.DRAG,function(e,t,n,o){H.apply(i.callback.onDrag,[t,n,o])}),e.bind(t.DRAGMOVE,function(e,t,n,o){H.apply(i.callback.onDragMove,[t,n,o])}),e.bind(t.DROP,function(e,t,n,o,r,a,d){H.apply(i.callback.onDrop,[t,n,o,r,a,d])})}),K.addInitUnBind(function(e){var e=e.treeObj,t=z.event;e.unbind(t.RENAME),e.unbind(t.DRAG),e.unbind(t.DRAGMOVE),e.unbind(t.DROP)}),K.addInitCache(function(){}),K.addInitNode(function(e,t,n){n&&(n.isHover=!1,n.editNameFlag=!1)}),K.addInitProxy(function(e){var t=e.target,n=K.getSetting(e.data.treeId),o=e.relatedTarget,r="",a=null,d="",i=null,l=null;if(H.eqs(e.type,"mouseover")?(l=H.getMDom(n,t,[{tagName:"a",attrName:"treeNode"+z.id.A}]))&&(r=H.getNodeMainDom(l).id,d="hoverOverNode"):H.eqs(e.type,"mouseout")?(l=H.getMDom(n,o,[{tagName:"a",attrName:"treeNode"+z.id.A}]))||(r="remove",d="hoverOutNode"):H.eqs(e.type,"mousedown")&&(l=H.getMDom(n,t,[{tagName:"a",attrName:"treeNode"+z.id.A}]))&&(r=H.getNodeMainDom(l).id,d="mousedownNode"),0<r.length)switch(a=K.getNodeCache(n,r),d){case"mousedownNode":i=s.onMousedownNode;break;case"hoverOverNode":i=s.onHoverOverNode;break;case"hoverOutNode":i=s.onHoverOutNode}return{stop:!1,node:a,nodeEventType:d,nodeEventCallback:i,treeEventType:"",treeEventCallback:null}}),K.addInitRoot(function(e){var e=K.getRoot(e),t=K.getRoots();e.curEditNode=null,e.curEditInput=null,e.curHoverNode=null,e.dragFlag=0,e.dragNodeShowBefore=[],e.dragMaskList=[],t.showHoverDom=!0}),K.addZTreeTools(function(i,e){e.cancelEditName=function(e){K.getRoot(this.setting).curEditNode&&Y.cancelCurEditNode(this.setting,e||null,!0)},e.copyNode=function(e,t,n,o){if(!t)return null;var r=K.nodeIsParent(i,e);if(e&&!r&&this.setting.data.keep.leaf&&n===z.move.TYPE_INNER)return null;var a=this,d=H.clone(t);return e||(e=null,n=z.move.TYPE_INNER),n==z.move.TYPE_INNER?(t=function(){Y.addNodes(a.setting,e,-1,[d],o)},H.canAsync(this.setting,e)?Y.asyncNode(this.setting,e,o,t):t()):(Y.addNodes(this.setting,e.parentNode,-1,[d],o),Y.moveNode(this.setting,e,d,n,!1,o)),d},e.editName=function(e){e&&e.tId&&e===K.getNodeCache(this.setting,e.tId)&&(e.parentTId&&Y.expandCollapseParentNode(this.setting,e.getParentNode(),!0),Y.editNode(this.setting,e))},e.moveNode=function(e,t,n,o){function r(){Y.moveNode(d.setting,e,t,n,!1,o)}if(!t)return t;var a=K.nodeIsParent(i,e);if(e&&!a&&this.setting.data.keep.leaf&&n===z.move.TYPE_INNER)return null;if(e&&(t.parentTId==e.tId&&n==z.move.TYPE_INNER||0<V(t,this.setting).find("#"+e.tId).length))return null;e=e||null;var d=this;return H.canAsync(this.setting,e)&&n===z.move.TYPE_INNER?Y.asyncNode(this.setting,e,o,r):r(),t},e.setEditable=function(e){return this.setting.edit.enable=e,this.refresh()}});var a=Y.cancelPreSelectedNode;Y.cancelPreSelectedNode=function(e,t){for(var n=K.getRoot(e).curSelectedList,o=0,r=n.length;o<r&&(t&&t!==n[o]||(Y.removeTreeDom(e,n[o]),!t));o++);a&&a.apply(Y,arguments)};var d=Y.createNodes;Y.createNodes=function(e,t,n,o,r){d&&d.apply(Y,arguments),n&&Y.repairParentChkClassWithSelf&&Y.repairParentChkClassWithSelf(e,o)};var n=Y.makeNodeUrl;Y.makeNodeUrl=function(e,t){return e.edit.enable?null:n.apply(Y,arguments)};var o=Y.removeNode;Y.removeNode=function(e,t){e=K.getRoot(e);e.curEditNode===t&&(e.curEditNode=null),o&&o.apply(Y,arguments)};var r=Y.selectNode;Y.selectNode=function(e,t,n){var o=K.getRoot(e);return(!K.isSelectedNode(e,t)||o.curEditNode!=t||!t.editNameFlag)&&(r&&r.apply(Y,arguments),Y.addHoverDom(e,t),!0)};var i=H.uCanDo;H.uCanDo=function(e,t){e=K.getRoot(e);return!(!t||!(H.eqs(t.type,"mouseover")||H.eqs(t.type,"mouseout")||H.eqs(t.type,"mousedown")||H.eqs(t.type,"mouseup")))||(e.curEditNode&&(Y.editNodeBlur=!1,e.curEditInput.focus()),!e.curEditNode&&(!i||i.apply(Y,arguments)))}}(jQuery);